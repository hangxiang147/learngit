<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>
<!DOCTYPE html> 
<html lang="zh-CN">
<head>
	<style type="text/css">
		.tab{color:#555555;box-shadow:0px 1px 5px #dddddd;}
		.tab table{width:100%;border-collapse:collapse;}
		.tab table tr td{border:1px solid #ddd;word-wrap:break-word;font-size:14px;}
		.tab table tbody tr td{height:auto;line-height:20px;padding:10px 10px;}
		.tab table tr .title {text-align:center;color:#000;width:15%}
		.bold{font-weight:bold}
	</style>
</head>
<body>
	<div class="container-fluid">
      <div class="row">
      	<s:set name="panel" value="'application'"></s:set>
        <s:set name="selectedPanel" value="'myProcessList'"></s:set>
        <%@include file="/pages/administration/panel.jsp" %>	
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        		<c:if test="${businessType=='ChangeContract'}">
        			<div id="printArea">
        	  	<h4 style="text-align:center" class="bold">合同变更或解除申请
        	  	<button id="return" type="button" class="btn btn-default"
						onclick="location.href='javascript:history.go(-1)'" style="float:right;margin-top:-10px"
						>返回</button>
						<div style="float:right;height:20px;width:10px"></div>
       					<button id="print" type="button" class="btn btn-default"
						onclick="printOrder()" style="float:right;margin-top:-10px;"
						>打印</button></h4>
        	  	<div class="tab">
        	  	<table>
        	  		<tr>
        	  			<td class="title">所属部门</td>
        	  			<td style="width:24%">${department}</td>
        	  			<td class="title">申请人</td>
        	  			<td>${changeContractVo.userName}</td>
        	  			<td class="title">申请日期</td>
        	  			<td style="width:16%">${changeContractVo.requestDate}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">合同基本信息</td></tr>
        	  		<tr>
        	  			<td class="title">合同名称</td>
        	  			<td colspan="5">${changeContractVo.contractName}</td>
        	  		</tr>
        	  		<tr>
						<td class="title">合同编号</td>
						<td colspan="3">${changeContractVo.contractId}</td>
						<td class="title">签订时间</td>
						<td>${changeContractVo.signDate}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">合同内容</td>
        	  			<td colspan="5">${changeContractVo.contractContent}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">合同已履行情况介绍</td>
        	  			<td colspan="5">${changeContractVo.contractDescription}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title" rowspan="3">变更合同</td>
        	  			<td class="title">变更合同原因</td>
        	  			<td colspan="4">${changeContractVo.changeReason}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">变更前内容</td>
        	  			<td colspan="4">${changeContractVo.beforeChangeContent}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">变更后内容</td>
        	  			<td colspan="4">${changeContractVo.afterChangeContent}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">解除合同原因</td>
        	  			<td colspan="4">${changeContractVo.relieveReason}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">审批情况</td></tr>
        	  		<tr>
        	  			<td rowspan="2">部门主管</td>
        	  			<td colspan="5">审批意见：
        	  				<c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[1].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[1].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[1].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="2">分管副总审批</td>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[2].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[2].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[2].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="2">总经理（法定代表人）审批</td>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[3].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[3].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[3].endTime}</td>
        	  		</tr>
        	  	</table>
        	  	</div>
        	  	</div>
        		</c:if>
        		<c:if test="${businessType=='ContractSign'}">
        			<div id="printArea">
       	  	        	<h4 style="text-align:center" class="bold">合同审批表
       					<button id="return" type="button" class="btn btn-default"
						onclick="location.href='javascript:history.go(-1)'" style="float:right;margin-top:-10px"
						>返回</button>
						<div style="float:right;height:20px;width:10px"></div>
       					<button id="print" type="button" class="btn btn-default"
						onclick="printOrder()" style="float:right;margin-top:-10px;"
						>打印</button></h4>
        	  	<div style="text-align:right;margin-right:20px">合同编号：<span class="underline">${contractSignVo.contractId}</span></div>
        	  	<div class="tab">
        	  	<table>
        	  		<tr>
        	  			<td class="title">主办部门</td>
        	  			<td style="width:24%">${department}</td>
        	  			<td class="title">拟稿人</td>
        	  			<td>${contractSignVo.userName}</td>
        	  			<td class="title">提交日期</td>
        	  			<td style="width:16%">${contractSignVo.requestDate}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">合同基本信息</td></tr>
        	  		<tr>
        	  			<td class="title">合同名称</td>
        	  			<td colspan="5">${contractSignVo.contractName}</td>
        	  		</tr>
        	  		<tr>
						<td class="title">对方公司名称</td>
						<td colspan="3">${contractSignVo.otherCompanyName}</td>
						<td class="title">合同金额</td>
						<td>${contractSignVo.money}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">合同详情</td>
        	  			<td colspan="5">${contractSignVo.description}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">审批情况</td></tr>
        	  		<tr>
        	  			<td rowspan="2">主办部门经理</td>
        	  			<td colspan="5">审批意见：
        	  				<c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[1].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[1].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[1].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="4">财务部负责人</td>
        	  			<td class="title" rowspan="2">仅限支出类合同</td>
        	  			<c:if test="${contractSignVo.isPay=='1'}">
	        	  			<td colspan="2">是否超出本季度预算 </td>
	        	  			<td>
	        	  				<input type="checkbox" onclick="return false;" ${contractSignVo.exceedSeason=='0'?'checked':''} style="height:15px;width:15px">&nbsp;<label style="margin-bottom:2px">否</label>&nbsp;&nbsp;&nbsp;
	        	  				<input type="checkbox" onclick="return false;" ${contractSignVo.exceedSeason=='1'?'checked':''} style="height:15px;width:15px">&nbsp;<label>是</label>
	        	  			</td>
	        	  			<td>超出比例（   ${contractSignVo.exceedSeasonRate}%）</td>
        	  			</c:if>
        	  			<c:if test="${contractSignVo.isPay=='0'}">
	        	  			<td colspan="2">是否超出本季度预算 </td>
	        	  			<td>
	        	  				<input type="checkbox" onclick="return false;" style="height:15px;width:15px">&nbsp;<label style="margin-bottom:2px">否</label>&nbsp;&nbsp;&nbsp;
	        	  				<input type="checkbox" onclick="return false;" style="height:15px;width:15px">&nbsp;<label>是</label>
	        	  			</td>
	        	  			<td>超出比例（   &nbsp;%）</td>
        	  			</c:if>
        	  		</tr>
        	  		<tr>
        	  			<c:if test="${contractSignVo.isPay=='1'}">
        	  			 <td colspan="2">是否超出集团审定预算 </td>
        	  			 <td>
        	  				<input type="checkbox" onclick="return false;" ${contractSignVo.exceedGroup=='0'?'checked':''} style="height:15px;width:15px">&nbsp;<label>否</label>&nbsp;&nbsp;&nbsp;
        	  				<input type="checkbox" onclick="return false;" ${contractSignVo.exceedGroup=='1'?'checked':''} style="height:15px;width:15px">&nbsp;<label>是</label>
        	  			</td>
        	  			<td>超出比例（    ${contractSignVo.exceedGroupRate}%）</td>
        	  			</c:if>
        	  			<c:if test="${contractSignVo.isPay=='0'}">
        	  			 <td colspan="2">是否超出集团审定预算 </td>
        	  			 <td>
        	  				<input type="checkbox" onclick="return false;" style="height:15px;width:15px">&nbsp;<label>否</label>&nbsp;&nbsp;&nbsp;
        	  				<input type="checkbox" onclick="return false;" style="height:15px;width:15px">&nbsp;<label>是</label>
        	  			</td>
        	  			<td>超出比例（   &nbsp;%）</td>
        	  			</c:if>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[2].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[2].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[2].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="2">分管副总审批</td>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[3].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[3].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[3].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="2">总经理（法定代表人）审批</td>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[4].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[4].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[4].endTime}</td>
        	  		</tr>
        	  	</table>
        	  	</div>
        	  	</div>
        		</c:if>
        		<c:if test="${businessType=='bankAccount'}">
        				<div id="printArea">
        	  	<h4 style="text-align:center" class="bold">开设、变更及撤销银行账户申请表
        	  	<button id="return" type="button" class="btn btn-default"
						onclick="location.href='javascript:history.go(-1)'" style="float:right;margin-top:-10px"
						>返回</button>
						<div style="float:right;height:20px;width:10px"></div>
       					<button id="print" type="button" class="btn btn-default"
						onclick="printOrder()" style="float:right;margin-top:-10px;"
						>打印</button></h4>
        	  	<div class="tab">
        	  	<table>
        	  		<tr>
        	  			<td class="title">申请部门</td>
        	  			<td style="width:24%">${department}</td>
        	  			<td class="title">经办人</td>
        	  			<td>${changeBankAccountVo.userName}</td>
        	  			<td class="title">申请日期</td>
        	  			<td style="width:16%">${changeBankAccountVo.requestDate}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">账户基本信息</td></tr>
        	  		<tr>
        	  			<td class="title">单位名称</td>
        	  			<td colspan="5">${changeBankAccountVo.accountCompanyName}</td>
        	  		</tr>
        	  		<tr>
						<td class="title">开户行全称</td>
						<td colspan="5">${changeBankAccountVo.bankName}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">账户类别</td>
        	  			<td colspan="2">${changeBankAccountVo.accountType}</td>
        	  			<td class="title">账   号</td>
        	  			<td colspan="2">${changeBankAccountVo.accountNumber}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">申请信息</td></tr>
        	  		<tr>
        	  			<td class="title" rowspan="2">开立</td>
        	  			<td class="title">开户依据</td>
        	  			<td colspan="4">${changeBankAccountVo.newAccountReason}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">账户用途</td>
        	  			<td colspan="4">${changeBankAccountVo.accountUse}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title" rowspan="3">变更</td>
        	  			<td class="title">变更事项</td>
        	  			<td colspan="4">${changeBankAccountVo.changeItem}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">变更后信息</td>
        	  			<td colspan="4">${changeBankAccountVo.afterChangeInfo}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">变更原因</td>
        	  			<td colspan="4">${changeBankAccountVo.changeReason}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title" rowspan="2">撤销</td>
        	  			<td class="title">销户原因</td>
        	  			<td colspan="4">${changeBankAccountVo.deleteAccountReason}</td>
        	  		</tr>
        	  		<tr>
        	  			<td class="title">资金去向</td>
        	  			<td colspan="4">${changeBankAccountVo.moneyWhere}</td>
        	  		</tr>
        	  		<tr><td colspan="6" class="bold" style="text-align:center;background:#efefef">审批情况</td></tr>
        	  		<tr>
        	  			<td rowspan="2">部门主管</td>
        	  			<td colspan="5">审批意见：
        	  				<c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[1].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[1].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[1].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="2">分管副总审批</td>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[2].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[2].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[2].endTime}</td>
        	  		</tr>
        	  		<tr>
        	  			<td rowspan="2">总经理（法定代表人）审批</td>
        	  			<td colspan="5">审批意见：
        	  			    <c:forEach items="${comments }" var="comment" varStatus="st">
	        	  				<c:if test="${comment.taskID == finishedTaskVOs[3].taskID }">
					  			${comment.content }
	        	  				</c:if>
        	  				</c:forEach>
        	  			</td>
        	  		</tr>
        	  		<tr>
        	  			<td colspan="3">签字：${finishedTaskVOs[3].assigneeName}</td>
        	  			<td>日期：</td>
        	  			<td>${finishedTaskVOs[3].endTime}</td>
        	  		</tr>
        	  	</table>
        	  	</div>
        	  	</div>
        		</c:if>
        </div>
      </div>
    </div>
        <script type="text/javascript">
    	function printOrder(){
    	$("#return").remove();
    	$("#print").remove();
	  	var content=$('#printArea').html();
		$('body').empty().html(content);
		window.print();
		var argSearch = location.search;
		argSearch = argSearch.substring(1, argSearch.length);
		var args = argSearch.split("&");
		args.forEach(function(value, index){
			if(index==1){
				$("input[name='businessType']").val(value.split("=")[1]);
			}else{
				$("input[name='processInstanceID']").val(value.split("=")[1]);
			}
		});
		window.location.reload();
	   	}
		var search=location.search;
		//假如参数为空  这种情况 不可能发生 除了 从 print 页跳转回来
		if(!search){
			location.href=localStorage.lastUrl;
		}
		localStorage.lastUrl=location.href;
	</script>
	<input name="processInstanceID" type="hidden"/>
	<input name="businessType" type="hidden"/>
</body>
</html>