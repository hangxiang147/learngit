<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>
<!DOCTYPE html> 
<html lang="zh-CN">
<head>
<script src="/assets/js/layer/layer.js"></script>
<script type="text/javascript">
	//限制先选开始时间
	function checkBegintime(){
		if($("#endDate").val()!='' && $("#beginDate").val()==''){
			layer.alert("请先选择开始时间",{"offset":"100px"});
			$("#endDate").val("");
		}
	}
	//计算加班工时
	function calcTime(){
		var beginDate = $("#beginDate").val();
		var endDate = $("#endDate").val();
		if(beginDate!='' && endDate!=''){
			beginDate = beginDate.replace(/-/g,"/");
      		endDate = endDate.replace(/-/g,"/");
      		var differTime = new Date(endDate).getTime() - new Date(beginDate).getTime();
      		//加班时间按半小时起算，向下取值
      		var hours = Math.floor(differTime/(60*30*1000))/2;
      		//加班工时不足半小时
      		if(hours<=0){
      			layer.alert("加班工时不足半小时，无法申请加班",{"offset":"100px"});
      			$("#endDate").val("");
      			$("input[name='workOvertimeVo.workHours']").val("");
      			return;
      		}
      		$("input[name='workOvertimeVo.workHours']").val(hours+"小时");
		}
	}
</script>
<style type="text/css">
	
</style>
</head>
<body>
	<div class="container-fluid">
      <div class="row">
         <%@include file="/pages/personal/panel.jsp" %>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        	<form action="personal/save_startWorkOvertime" method="post" class="form-horizontal" onsubmit="return check()" enctype="multipart/form-data">
        	  <s:token></s:token>
        	  <h2 class="sub-header" style="margin-top:0px;">发起加班申请<span style="color:red;font-size:20px">（加班时间按半小时起算）</span></h2> 
		 	  <input style="display:none" name="workOvertimeVo.userName"  value="${staff.lastName}"/>
 			  <input style="display:none" name="workOvertimeVo.userID"  value="${staff.userID}"/>
			  <div class="form-group" id="beginDate_div">
	    		<label class="col-sm-1 control-label" style="width:11%">开始时间<span style="color:red"> *</span></label>
	    		<div class="col-sm-3">
	    			<input type="text" class="form-control" id="beginDate" name="workOvertimeVo.beginDate" autoComplete="off"
	    			 required onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss', minDate:'%y-%M-%d 19:00:00', maxDate:'%y-%M-%d 23:59:59'})" onBlur="calcTime()" />
	    		</div>
	    	  </div> 
	    	  <div class="form-group" id="endDate_div">
	    		<label class="col-sm-1 control-label" style="width:11%">结束时间<span style="color:red"> *</span></label>
	    		<div class="col-sm-3">
	    			<input type="text" class="form-control" id="endDate" name="workOvertimeVo.endDate" autoComplete="off"
	    			required onclick="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss', minDate:'#F{$dp.$D(\'beginDate\')}', maxDate:'${beginDay}${beginTime}'})" onBlur="checkBegintime(), calcTime()"/>
	    			
	    		</div>
	    	  </div> 
	    	  <div class="form-group">
	    	  	<label class="col-sm-1 control-label" style="width:11%">预计加班工时</label>
	    	  	<div class="col-sm-3"><input class="form-control" readonly name="workOvertimeVo.workHours" ></div>
	    	  </div>
			  <div class="form-group">
			  	<label class="col-sm-1 control-label" style="width:11%">原因<span style="color:red"> *</span></label>
			    <div class="col-sm-5">
			    	<input type="text" class="form-control" id="reason" name="workOvertimeVo.reason" autoComplete="off" required/>
			    </div>
			  </div>
			  <div class="form-group">
			    <button type="submit" id="submitButton" class="btn btn-primary" style="margin-left:3%">提交</button>
			  </div>
			</form>
        </div>
      </div>
    </div>
</body>
</html>